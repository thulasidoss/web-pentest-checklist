# Pentesting Web Checklist

## Recon Phase

- **Large Scope**
    - Get ASN for IP ranges (amass, asnlookup, metabigor, bgp)
    - Review latest acquisitions
    - Get relationships by registrants (viewdns)
    - Go to medium scope for each domain

- **Medium Scope**
    - Enumerate subdomains (amass or subfinder with all available API keys)
    - Subdomain bruteforce (puredns with wordlist)
    - Permute subdomains (gotator or ripgen with wordlist)
    - Identify alive subdomains (httpx)
    - Subdomain takeovers (nuclei-takeovers)
    - Check for cloud assets (cloudenum)
    - Shodan search
    - Transfer zone
    - Subdomains recursive search
    - Take screenshots (gowitness, webscreenshot, aquatone)

- **Small Scope**
    - Identify web server, technologies, and database (httpx)
    - Try to locate /robots.txt , /crossdomain.xml /clientaccesspolicy.xml /sitemap.xml and /.well-known/
    - Review comments on source code (Burp Engagement Tools)
    - Directory enumeration
    - Web fuzzing (ffuf and wordlist)
    - Find leaked ids, emails (pwndb)
    - Identify WAF (whatwaf, wafw00f)
    - Google dorking
    - GitHub dorking/Github tools (githound, gitdorks_go)
    - Get urls (gau , waybackurls, gospider)
    - Check potential vulnerable urls (gf-patterns)
    - Automatic XSS finder (dalfox)
    - Locate admin and login panel
    - Broken link hijacking (blc)

- **Network**
    - Check ICMP packets allowed
    - Check DMARC/SPF policies (spoofcheck)
    - Open ports with Shodan
    - Port scan to all ports
    - Check UDP ports (udp-proto-scanner or nmap)
    - Test SSL (testssl)
    - If got creds, try password spraying for all the services discovered

- **Preparation**
    - Study site structure
    - Make a list with all possible test cases
    - Understand the business area and what their customer needs
    - Get a list of every asset (all_subdomains.txt, live_subdomains.txt, waybackurls.txt, hidden_directories.txt, nmap_results.txt, GitHub_search.txt, altdns_subdomain.txt, vulnerable_links.txt, js_files.txt)

# User Management

## Registration

- Duplicate registration (try with uppercase, +1@..., dots in name, etc)
- Overwrite existing user (existing user takeover)
- Username uniqueness
- Weak password policy (user=password, password=123456,111111,abcabc,qwerty12)
- Insufficient email verification process (also my%00email@mail.com for account tko)
- Weak registration implementation or allows disposable email addresses
- Fuzz after user creation to check if any folder has been overwritten or created with your profile name
- Add only spaces in password
- Long password (>200) leads to DoS
- Corrupt authentication and session defects: Sign up, don't verify, request change password, change, check if account is active.
- Try to re-register repeating the same request with the same password and a different password too
- If JSON request, add comma {“email”:“victim@mail.com”,”hacker@mail.com”,“token”:”xxxxxxxxxx”}
- Lack of confirmation -> try to register with a company email.
- Check OAuth with social media registration
- Check state parameter on social media registration
- Try to capture integration URL leading integration takeover
- Check redirections on the register page after login
- Rate limit on account creation
- XSS on name or email

## Configuration Management

- Check for commonly used application and administrative URLs 
- Check for old, backup, and unreferenced files 
- Check HTTP methods supported and Cross-Site Tracing (XST) 
- Test file extensions handling 
- Test for security HTTP headers (e.g. CSP, X-Frame-Options, HSTS) 
- Test for policies (e.g. Flash, Silverlight, robots) 
- Test for non-production data in a live environment, and vice-versa 
- Check for sensitive data in client-side code (e.g. API keys, credentials)

## Secure Transmission

- Check SSL Version, Algorithms, Key length 
- Check for Digital Certificate Validity (Duration, Signature and CN) 
- Check credentials only delivered over HTTPS 
- Check that the login form is delivered over HTTPS 
- Check session tokens only delivered over HTTPS 
- Check if HTTP Strict Transport Security (HSTS) is in use
