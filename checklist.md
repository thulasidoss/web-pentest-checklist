# Pentesting Web Checklist

## Recon Phase

- **Large Scope**
    - Get ASN for IP ranges (amass, asnlookup, metabigor, bgp)
    - Review latest acquisitions
    - Get relationships by registrants (viewdns)
    - Go to medium scope for each domain

- **Medium Scope**
    - Enumerate subdomains (amass or subfinder with all available API keys)
    - Subdomain bruteforce (puredns with wordlist)
    - Permute subdomains (gotator or ripgen with wordlist)
    - Identify alive subdomains (httpx)
    - Subdomain takeovers (nuclei-takeovers)
    - Check for cloud assets (cloudenum)
    - Shodan search
    - Transfer zone
    - Subdomains recursive search
    - Take screenshots (gowitness, webscreenshot, aquatone)

- **Small Scope**
    - Identify web server, technologies, and database (httpx)
    - Try to locate /robots.txt , /crossdomain.xml /clientaccesspolicy.xml /sitemap.xml and /.well-known/
    - Review comments on source code (Burp Engagement Tools)
    - Directory enumeration
    - Web fuzzing (ffuf and wordlist)
    - Find leaked ids, emails (pwndb)
    - Identify WAF (whatwaf, wafw00f)
    - Google dorking
    - GitHub dorking/Github tools (githound, gitdorks_go)
    - Get urls (gau , waybackurls, gospider)
    - Check potential vulnerable urls (gf-patterns)
    - Automatic XSS finder (dalfox)
    - Locate admin and login panel
    - Broken link hijacking (blc)

- **Network**
    - Check ICMP packets allowed
    - Check DMARC/SPF policies (spoofcheck)
    - Open ports with Shodan
    - Port scan to all ports
    - Check UDP ports (udp-proto-scanner or nmap)
    - Test SSL (testssl)
    - If got creds, try password spraying for all the services discovered

- **Preparation**
    - Study site structure
    - Make a list with all possible test cases
    - Understand the business area and what their customer needs
    - Get a list of every asset (all_subdomains.txt, live_subdomains.txt, waybackurls.txt, hidden_directories.txt, nmap_results.txt, GitHub_search.txt, altdns_subdomain.txt, vulnerable_links.txt, js_files.txt)

# User Management

## Registration

- Duplicate registration (try with uppercase, +1@..., dots in name, etc)
- Overwrite existing user (existing user takeover)
- Username uniqueness
- Weak password policy (user=password, password=123456,111111,abcabc,qwerty12)
- Insufficient email verification process (also my%00email@mail.com for account tko)
- Weak registration implementation or allows disposable email addresses
- Fuzz after user creation to check if any folder has been overwritten or created with your profile name
- Add only spaces in password
- Long password (>200) leads to DoS
- Corrupt authentication and session defects: Sign up, don't verify, request change password, change, check if account is active.
- Try to re-register repeating the same request with the same password and a different password too
- If JSON request, add comma {“email”:“victim@mail.com”,”hacker@mail.com”,“token”:”xxxxxxxxxx”}
- Lack of confirmation -> try to register with a company email.
- Check OAuth with social media registration
- Check state parameter on social media registration
- Try to capture integration URL leading integration takeover
- Check redirections on the register page after login
- Rate limit on account creation
- XSS on name or email

## Configuration Management

- Check for commonly used application and administrative URLs 
- Check for old, backup, and unreferenced files 
- Check HTTP methods supported and Cross-Site Tracing (XST) 
- Test file extensions handling 
- Test for security HTTP headers (e.g. CSP, X-Frame-Options, HSTS) 
- Test for policies (e.g. Flash, Silverlight, robots) 
- Test for non-production data in a live environment, and vice-versa 
- Check for sensitive data in client-side code (e.g. API keys, credentials)

## Security Headers

- X-XSS-Protection
- Strict-Transport-Security
- Content-Security-Policy
- Public-Key-Pins
- X-Frame-Options
- X-Content-Type-Options
- Referer-Policy
- Cache-Control
- Expires


## Secure Transmission

- Check SSL Version, Algorithms, Key length 
- Check for Digital Certificate Validity (Duration, Signature and CN) 
- Check credentials only delivered over HTTPS 
- Check that the login form is delivered over HTTPS 
- Check session tokens only delivered over HTTPS 
- Check if HTTP Strict Transport Security (HSTS) is in use


# Authentication

- Username Enumeration
- Resilience to password guessing
- Account recovery function
- "Remember me" function
- Impersonation function
- Unsafe distribution of credentials
- Fail-open conditions
- Multi-stage mechanisms
- SQL Injections
- Auto-complete testing
- Lack of password confirmation on change email, password, or 2FA (try change response)
- Weak login function over HTTP and HTTPS if both are available
- User account lockout mechanism on brute force attack
- Check for password wordlist (cewl and burp-goldenNuggets)
- Test OAuth login functionality for Open Redirection
- Test response tampering in SAML authentication
- In OTP check guessable codes and race conditions
- OTP, check response manipulation for bypass
- OTP, try brute force
- If JWT, check common flaws
- Browser cache weakness (e.g., Pragma, Expires, Max-age)
- After register, logout, clean cache, go to home page and paste your profile URL in the browser, check for "login?next=accounts/profile" for open redirect or XSS with "/login?next=javascript:alert(1);//"
- Try login with common credentials

# Session
- Session handling
- Test tokens for meaning
- Test tokens for predictability
- Insecure transmission of tokens
- Disclosure of tokens in logs
- Mapping of tokens to sessions
- Session termination
- Session fixation
- Cross-site request forgery
- Cookie scope
- Decode Cookie (Base64, hex, URL, etc.)
- Cookie expiration time
- Check HTTPOnly and Secure flags
- Use the same cookie from a different effective IP address or system
- Access controls
- Effectiveness of controls using multiple accounts
- Insecure access control methods (request parameters, Referer header, etc)
- Check for concurrent login through different machine/IP
- Bypass AntiCSRF tokens
- Weak generated security questions
- Path traversal on cookies
- Reuse cookie after session closed
- Logout and click browser "go back" function (Alt + Left arrow)
- 2 instances open, 1st change or reset password, refresh 2nd instance
- With privileged user perform privileged actions, try to repeat with unprivileged user cookie.

# Authorization

- Test for path traversal  
- Test for bypassing authorization schema  
- Test for vertical Access control problems (a.k.a. Privilege Escalation)  
- Test for horizontal Access control problems (between two users at the same privilege level)  
- Test for missing authorization



# Profile/Account Details
- Find parameter with user id and try to tamper to get the details of other users
- Create a list of features that are pertaining to a user account only and try CSRF
- Change email id and update with any existing email id. Check if it's getting validated on the server or not.
- Check any new email confirmation link and what if the user doesn't confirm.
- File upload: eicar, No Size Limit, File extension, Filter Bypass, burp extension, RCE
- CSV import/export: Command Injection, XSS, macro injection
- Check profile picture URL and find email id/user info or EXIF Geolocation Data
- Imagetragick in picture profile upload
- Metadata of all downloadable files (Geolocation, usernames)
- Account deletion option and try to reactivate with "Forgot password" feature
- Try bruteforce enumeration when changing any user unique parameter.
- Check application request re-authentication for sensitive operations
- Try parameter pollution to add two values of the same field
- Check different roles policy

# Data Validation

- Test for Reflected Cross Site Scripting  
- Test for Stored Cross Site Scripting  
- Test for DOM based Cross Site Scripting  
- Test for Cross Site Flashing  
- Test for HTML Injection  
- Test for SQL Injection  
- Test for LDAP Injection  
- Test for ORM Injection  
- Test for XML Injection  
- Test for XXE Injection  
- Test for SSI Injection  
- Test for XPath Injection  
- Test for XQuery Injection  
- Test for IMAP/SMTP Injection  
- Test for Code Injection  
- Test for Expression Language Injection  
- Test for Command Injection  
- Test for Overflow (Stack, Heap and Integer)  
- Test for Format String  
- Test for incubated vulnerabilities  
- Test for HTTP Splitting/Smuggling  
- Test for HTTP Verb Tampering  
- Test for Open Redirection  
- Test for Local File Inclusion  
- Test for Remote File Inclusion  
- Compare client-side and server-side validation rules  
- Test for NoSQL injection  
- Test for HTTP parameter pollution  
- Test for auto-binding  
- Test for Mass Assignment  
- Test for NULL/Invalid Session Cookie  


# Forgot/Reset Password
- Invalidate session on Logout and Password reset
- Uniqueness of forget password reset link/code
- Reset links expiration time
- Find user id or other sensitive fields in reset link and tamper them
- Request 2 reset passwords links and use the older
- Check if many requests have sequential tokens
- Use username@burp_collab.net and analyze the callback
- Host header injection for token leakage
- Add X-Forwarded-Host: evil.com to receive the reset link with evil.com
- Email crafting like victim@gmail.com@target.com
- IDOR in reset link
- Capture reset token and use it with other email/userID
- No TLD in email parameter
- User carbon copy email=victim@mail.com%0a%0dcc:hacker@mail.com
- Long password (>200) leads to DoS
- No rate limit, capture request and send over 1000 times
- Check encryption in reset password token
- Token leak in referer header
- Append second email param and value
- Understand how token is generated (timestamp, username, birthdate,...)
- Response manipulation

# Infrastructure

- Segregation in shared infrastructures
- Segregation between ASP-hosted applications
- Web server vulnerabilities
- Dangerous HTTP methods
- Proxy functionality
- Virtual hosting misconfiguration (VHostScan)
- Check for internal numeric IP's in request
- Check for external numeric IP's and resolve it
- Test cloud storage
- Check the existence of alternative channels (www.web.com vs m.web.com)

# CAPTCHA

- Send old captcha value.
- Send old captcha value with old session ID.
- Request captcha absolute path like www.url.com/captcha/1.png
- Remove captcha with any adblocker and request again
- Bypass with OCR tool (easy one)
- Change from POST to GET
- Remove captcha parameter
- Convert JSON request to normal
- Try header injections

# Denial of Service

- Test for anti-automation 
- Test for account lockout 
- Test for HTTP protocol DoS 
- Test for SQL wildcard DoS 

# Cryptography

- Check if data which should be encrypted is not 
- Check for wrong algorithms usage depending on context 
- Check for weak algorithms usage 
- Check for proper use of salting 
- Check for randomness functions 

# Risky Functionality - File Uploads

- Test that acceptable file types are whitelisted 
- Test that file size limits, upload frequency and total file counts are defined and enforced 
- Test that file contents match the defined file type 
- Test that all file uploads have Anti-Virus scanning in place 
- Test that unsafe filenames are sanitized 
- Test that uploaded files are not directly accessible within the web root 
- Test that uploaded files are not served on the same hostname/port 
- Test that files and other media are integrated with the authentication and authorization schemas 

# Risky Functionality - Card Payment

- Test for known vulnerabilities and configuration issues on Web Server and Web Application 
- Test for default or guessable passwords 
- Test for non-production data in the live environment, and vice-versa 
- Test for Injection vulnerabilities 
- Test for Buffer Overflows 
- Test for Insecure Cryptographic Storage 
- Test for Insufficient Transport Layer Protection 
- Test for Improper Error Handling 
- Test for all vulnerabilities with a CVSS v2 score > 4.0 
- Test for Authentication and Authorization issues 
- Test for CSRF 

# HTML 5

- Test Web Messaging 
- Test for Web Storage SQL injection 
- Check CORS implementation 
- Check Offline Web Application 
